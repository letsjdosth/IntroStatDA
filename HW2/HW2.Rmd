---
title: "Homework Assignment 2"
author: "Seokjun Choi"
output:
  pdf_document: default
  html_document:
    df_print: paged
---



### \noindent Problem1.
**(Albert and Rizzo Chapter 3, problem 1.)**

**(Fast food eating preference). Fifteen students in a statistics class**
**were asked to state their preference among the three restaurants Wendys,**
**McDonalds, and Subway. The responses for the students are presented below.**

Wendys McDonalds Subway Subway Subway Wendys
Wendys Subway Wendys Subway Subway Subway
Subway Subway Subway

**a. Use the scan function to read these data into the R command window.**

```{r}
# restaurant <- scan(what="character")
restaurant <- c("Wendys", "McDonalds", "Subway", "Subway", "Subway", "Wendys",
  "Wendys", "Subway", "Wendys", "Subway", "Subway", "Subway", "Subway",
  "Subway", "Subway")
```

Because of compiling Rmd file, I put these data by string vector instead of using the 'scan' function.
If we use the 'scan' function, we can see below block from R iterpretator.


>\> restaurant <- scan(what="character")
>
>1: Wendys McDonalds Subway Subway Subway Wendys
>
>7: Wendys Subway Wendys Subway Subway Subway
>
>13: Subway Subway Subway
>
>16: 
>
>Read 15 items
>
>\> restaurant
>
> [1] "Wendys"    "McDonalds" "Subway"    "Subway"    "Subway"    "Wendys"   
>
> [7] "Wendys"    "Subway"    "Wendys"    "Subway"    "Subway"    "Subway"
>
>[13] "Subway"    "Subway"    "Subway"
>


**b. Use the table function to find the frequencies of students who prefer the three restaurants.**

```{r}
table(restaurant)
```


**c. Compute the proportions of students in each category.**

```{r}
restaurant_factor <- factor(restaurant)
restaurant_prop_table <- table(restaurant_factor) / length(restaurant_factor)
restaurant_prop_table
```

**d. Construct two different graphical displays of the proportions.**

```{r}
plot(restaurant_prop_table, 
  xlab = "restaurant", ylab = "proportion", main = "prefered restaurant")
barplot(restaurant_prop_table, 
  xlab = "restaurant", ylab = "proportion", main = "prefered restaurant")
```

\vspace{1cm}

### \noindent Problem2.
**(Albert and Rizzo Chapter 3, problem 3.)**

3.3 (Does baseball hitting data follow a binomial distribution?).
Albert Pujols is a baseball player who has $n$ opportunities to hit in a single
game. If $y$ denotes the number of hits for a game, then it is reasonable to
assume that $y$ has a binomial distribution with sample size $n$ and probability
of success $p = 0.312$, where $0.312$ is Pujols’ batting average (success rate) for
the 2010 baseball season.

a. In 70 games Pujols had exactly $n = 4$ opportunities to hit and the number of hits $y$ in these 70 games is tabulated in the following table. 

|Number of hits | Frequency|
|---|----|
| 0 | 17 |
| 1 | 31 |
| 2 | 17 |
|3 or more | 5 |

Use the dbinom function to compute the expected counts and the chisq.test
function to test if the counts follow a binomial(4, 0.312) distribution.

```{r}
observed_hit <- c(17, 31, 17, 5)
names(observed_hit) <- c("0", "1", "2", ">=3")
expected_prob <- dbinom(0:4, size = 4, prob = 0.312)
expected_hit <- expected_prob * 70
collapsed_expected_hit <- c(expected_hit[1:3], sum(expected_hit[4:5]))
collapsed_expected_prob <- c(expected_prob[1:3], sum(expected_prob[4:5]))
chisq_test_table <- data.frame(observed_hit, collapsed_expected_hit)
chisq_test_table
chisq_statistic <- sum((observed_hit - collapsed_expected_hit)^2 / collapsed_expected_hit)
p_val <- 1 - pchisq(chisq_statistic, length(observed_hit)-1)

c(chisq_statistic, p_val)

# R built-in function
chisq.test(observed_hit, p = collapsed_expected_prob)
```

The hypotheses are

H0: the observed 'number of hits' data follow a binomial(4, 0.312) distribution.

H1: Not h1.

The chi-square value is 0.97692, and it follows chi-square distribution with degree of freedom 3 under H0.
The p value is 0.8068.
Under a significance level less than 0.8068 (like 0.05 or 0.01), we cannot reject the H0.
Thus, we cannot say that the data do not follow binomial(4, 0.312) distribution.

```{r}
chisq.test(observed_hit, p = collapsed_expected_prob)$residual
```
All residual values are close to 0.


b. In 25 games Pujols had exactly $n = 5$ opportunities to hit and the number
of hits y in these 25 games is shown in the table below. 

|Number of hits | Frequency|
|---|----|
| 0 | 5 |
| 1 | 5 |
| 2 | 4 |
|3 or more | 11 |

Use the chisq.test function to test if the counts follow a binomial(5, 0.312) distribution.


```{r}
observed_hit5 <- c(5, 5, 4, 11)
names(observed_hit5) <- c("0", "1", "2", ">=3")
expected_prob5 <- dbinom(0:5, size = 5, prob = 0.312)
expected_hit5 <- expected_prob5 * 25

collapsed_expected_hit5 <- c(expected_hit5[1:3], sum(expected_hit5[4:6]))
collapsed_expected_prob5 <- c(expected_prob5[1:3], sum(expected_prob5[4:6]))
chisq_test_table5 <- data.frame(observed_hit5, collapsed_expected_hit5)
chisq_test_table5

chisq.test(collapsed_observed_hit5, p = collapsed_expected_prob5)
```

add explanaton!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

```{r}
collapsed2_observed_hit5 <- c(5, 5, 4 + 11)
names(observed_hit5) <- c("0", "1", ">=2")
collapsed2_expected_hit5 <- c(expected_hit5[1:2], sum(expected_hit5[3:6]))
collapsed2_expected_prob5 <- c(expected_prob5[1:2], sum(expected_prob5[3:6]))
collapsed2_chisq_test_table5 <- data.frame(collapsed2_observed_hit5, collapsed2_expected_hit5)
collapsed2_chisq_test_table5
collapsed2_chisq_statistic5 <- sum((collapsed2_observed_hit5 - collapsed2_expected_hit5)^2 / collapsed2_expected_hit5)
collapsed2_p_val5 <- 1 - pchisq(collapsed2_chisq_statistic5, length(collapsed2_observed_hit5)-1)

c(collapsed2_chisq_statistic5, collapsed2_p_val5)

# R built-in function
chisq.test(collapsed2_observed_hit5, p = collapsed2_expected_prob5)
```

The hypotheses are

H0: the observed 'number of hits' data follow a binomial(5, 0.312) distribution.

H1: Not h1.

The chi-square value is 2.4815, and it follows chi-square distribution with degree of freedom 2 under H0.
The p value is 0.8068.
Under a significance level less than 0.8068 (like 0.05 or 0.01), we cannot reject the H0.
Thus, we cannot say that the data do not follow binomial(4, 0.312) distribution.


### \noindent Problem3.
**(Albert and Rizzo Chapter 3, problem 4.)**
3.4 (Categorizing ages in the twins dataset). The variable AGE gives
the age (in years) of twin 1.
a. Use the cut function on AGE with the breakpoints 30, 40, and 50 to create
a categorized version of the twin’s age.
b. Use the table function to find the frequencies in the four age categories.
c. Construct a graph of the proportions in the four age categories.

### \noindent Problem4.
**(Albert and Rizzo Chapter 3, problem 5.)**
3.5 (Relating age and wage in the twins dataset). The variables AGE
and HRWAGEL contain the age (in years) and hourly wage (in dollars) of twin 1.

a. Using two applications of the cut function, create a categorized version
of AGE using the breakpoints 30, 40, and 50, and a categorized version of
HRWAGEL using the same breakpoints as in Section 3.3.

b. Using the categorized versions of AGE and HRWAGEL, construct a contingency table of the two variables using the function table.

c. Use the prop.table function to find the proportions of twins in each age
class that have the different wage groups.

d. Construct a suitable graph to show how the wage distribution depends on
the age of the twin.

e. Use the conditional proportions in part (c) and the graph in part (d) to
explain the relationship between age and wage of the twins.

### \noindent Problem5.
**(Albert and Rizzo Chapter 3, problem 6.)**
3.6 (Relating age and wage in the twins dataset, continued).

a. Using the contingency table of the categorized version of AGE and HRWAGEL
and the function chisq.test, perform a test of independence of age and wage. 
Based on this test, is there significant evidence to conclude that age and wage are dependent?

b. Compute and display the Pearson residuals from the test of independence.
Find the residuals that exceed 2 in absolute value.

c. Use the function mosaicplot with the argument shade=TRUE to construct
a mosaic plot of the table counts showing the extreme residuals.

d. Use the numerical and graphical work from parts (b) and (c) to explain
how the table of age and wages differs from an independence structure.


### \noindent Problem6.
**(Albert and Rizzo Chapter 3, problem 8.)**
3.8 (Are the digits of $\pi$ random?). The National Institute of Standards
and Technology has a web page that lists the first 5000 digits of the irrational
number $\pi$. One can read these digits into R by means of the script


```{r}
pidigits <- read.table(
    "http://www.itl.nist.gov/div898/strd/univ/data/PiDigits.dat",
     skip = 60)
```

a. Use the table function to construct a frequency table of the digits 1 through 9.
b. Construct a bar plot of the frequencies found in part (a).

c. Use the chi-square test, as implemented in the chisq.test function, to
test the hypothesis that the digits 1 through 9 are equally probable in the
digits of $\pi$.

### \noindent Problem7.
**(Albert and Rizzo Chapter 5, problem 2.)**

### \noindent Problem8.
**(Albert and Rizzo Chapter 5, problem 3.)**

### \noindent Problem9.
**(Albert and Rizzo Chapter 5, problem 5.)**

### \noindent Problem10.
**(Albert and Rizzo Chapter 5, problem 6.)**

### \noindent Problem11.
**(Albert and Rizzo Chapter 5, problem 7.)**